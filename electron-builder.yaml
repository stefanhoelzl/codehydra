appId: com.codehydra.app
productName: CodeHydra
copyright: Copyright Â© 2025 CodeHydra

# GitHub Releases for auto-update metadata generation
# Note: --publish=never flag in CI prevents actual upload
publish:
  provider: github
  owner: stefanhoelzl
  repo: codehydra

# Build directories
directories:
  output: dist
  buildResources: resources

# Files to include in the package
files:
  - out/**/*
  - package.json
  - "!out/**/*.map"
  - "!out/**/*.test.*"

# Copy files outside ASAR for external process access
# (ASAR contents not accessible by child_process.spawn/exec)
extraResources:
  - from: resources/icon.png
    to: icon.png
  - from: resources/icon.ico
    to: icon.ico
  # CLI wrapper scripts and hook handler (executed by Claude Code)
  - from: out/main/assets/bin
    to: bin
  # PowerShell scripts (executed by PowerShell)
  - from: out/main/assets/scripts
    to: scripts
  # VSIX files (installed by code-server)
  # Note: glob patterns require filter syntax
  - from: out/main/assets
    to: extensions
    filter:
      - "*.vsix"

# ASAR archive settings
asar: true
# Note: No asarUnpack needed - external process files use extraResources above,
# simple-git is pure JS, socket.io deps externalized in vite config

# Use normal compression for faster CI builds (default is maximum)
compression: normal

# Windows configuration
win:
  target:
    - target: nsis
      arch: [x64]
    - target: dir
      arch: [x64]
  icon: resources/icon.ico

# NSIS installer settings
nsis:
  oneClick: false
  allowToChangeInstallationDirectory: true
  artifactName: ${productName}-win-installer-${arch}.${ext}

# Linux configuration
linux:
  target:
    - target: AppImage
      arch: [x64]
  icon: resources/icon.png
  category: Development;IDE;TextEditor
  synopsis: Multi-workspace IDE for parallel AI agent development
  description: CodeHydra is a multi-workspace IDE designed for parallel AI agent development. Each workspace runs in an isolated environment with its own VS Code instance.
  desktop:
    entry:
      StartupWMClass: codehydra

# AppImage-specific settings
appImage:
  artifactName: ${productName}-linux-${arch}.${ext}

# macOS configuration
mac:
  target:
    - target: dir
      arch: [x64, arm64]
  icon: resources/icon.png
  category: public.app-category.developer-tools
